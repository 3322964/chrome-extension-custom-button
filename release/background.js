function initOptions(){"use strict";function o(o){if(void 0!==chrome.runtime.lastError)return void console.log("An error ocurred initializing options: "+chrome.runtime.lastError.string);customUrlGlobal=o.customUrl,domainGlobal=o.domain,domainRegExp=new RegExp(domainGlobal),modeGlobal=o.mode,notificationGlobal.show=o.notification.show,notificationGlobal.title=o.notification.title,notificationGlobal.text=o.notification.text;for(var t="",i=0;i<ICON_MAX_KEYS;i++)t+=o["icon"+i];notificationGlobal.icon=t,chrome.browserAction.setIcon({path:t}),modeGlobal===ModeEnum.POPUP_BUTTON?chrome.browserAction.setPopup({popup:"popup.html"}):chrome.browserAction.setPopup({popup:""})}var t={};t.customUrl=DEFAULT_URL,t.mode=ModeEnum.TAB_CURRENT,t.domain=".*",t.notification={show:!1,title:"Curtom Button",text:"URL doesn't match"};for(var i=0;i<ICON_MAX_KEYS;i++)t["icon"+i]="";t.icon0="images/default-64.png",chrome.storage.sync.get(t,o)}function readyUrl(o){return customUrlGlobal.replace("%url",o)}function checkDomain(o){return domainRegExp.test(o)}function showNotification(){if(notificationGlobal.show===!0){var o={type:"basic",title:notificationGlobal.title,message:notificationGlobal.text,iconUrl:notificationGlobal.icon};chrome.notifications.clear(notificationGlobal.id,function(){chrome.notifications.create(notificationGlobal.id,o,function(){})})}}var ModeEnum={TAB_CURRENT:0,TAB_NEW:1,WINDOW:2,POPUP_WINDOW:3,POPUP_BUTTON:4},domainRegExp,customUrlGlobal,domainGlobal,modeGlobal,notificationGlobal={id:"supermegacoolid",show:"",title:"",text:"",icon:""};chrome.browserAction.onClicked.addListener(function(o){"use strict";var t=o.url;if(void 0!==t&&checkDomain(t)){var i=readyUrl(t);switch(modeGlobal){case ModeEnum.TAB_CURRENT:chrome.tabs.update({url:i});break;case ModeEnum.TAB_NEW:chrome.tabs.create({url:i});break;case ModeEnum.WINDOW:chrome.windows.create({url:i,type:"normal"});break;case ModeEnum.POPUP_WINDOW:chrome.windows.create({url:i,type:"popup"})}}else showNotification()}),chrome.storage.onChanged.addListener(function(o,t){"use strict";var i,n,e,a="";for(i in o)o.hasOwnProperty(i)&&(n=o[i],e=n.newValue,"customUrl"===i?customUrlGlobal=e:"mode"===i?(e!==ModeEnum.POPUP_BUTTON?chrome.browserAction.setPopup({popup:""}):chrome.browserAction.setPopup({popup:"popup.html"}),modeGlobal=e):"notification"===i?(notificationGlobal.show=e.show,notificationGlobal.title=e.title,notificationGlobal.text=e.text):"domain"===i?(domainGlobal=n.newValue,domainRegExp=new RegExp(domainGlobal)):null!==i.match(/^icon[0-9]{1,2}$/)&&(a+=e));""!==a&&(notificationGlobal.icon=a,chrome.browserAction.setIcon({path:a}))}),document.addEventListener("DOMContentLoaded",initOptions);